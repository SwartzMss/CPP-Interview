---
title: 结构体与联合体要点
tags:
  - c
  - 结构体
  - 联合体
---

## 结构体

- 内存对齐按最大成员对齐，必要时补齐填充；示例 `char + int + short` 得到 12 字节。
- 调整成员顺序可减填充：`int + short + char` 压缩到 8 字节。
- 嵌套结构体继续对齐：含前述结构的包裹体可达 20 字节。
- 结构体赋值默认逐成员拷贝（浅拷贝）。
- 含柔性数组（flexible array member）时，`sizeof` 仅含固定部分，例如 `int len; char data[];` 结果等于 `sizeof(int)`。

## 联合体

- 联合体大小等于最大成员大小并按最大对齐取整，例如 `int` 与 `char[4]` 联合为 4 字节。
- 写入一个成员后读另一个成员会暴露字节序：`u.i = 0x12345678; u.c[0]` 小端得 `0x78`，大端得 `0x12`。
- 典型用途：节省内存、协议/寄存器解析、类型复用。
